<!DOCTYPE html>
<html>
  <head>
  <meta name="viewport" content="width=device-width, initial-scale=1">	
<meta charset="utf-8">
<meta name="author" content="Arthur Chan">
 <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.0.4/firebase.js"></script>
<script  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCYV_y-ik8euNR18vFI-VXHUmvNC-Z-d_s&libraries=places&callback=initialize" async defer ></script>
    <style>
      html, body {
        height: 100%;
        margin: 0;
      
      }
      #map {
        height: 100%;
        
        width:100%;
		
        
      }
	  #map-search{
		width:25%;
		margin-top: 7%;
		margin-left: 2%;
		border-right: none;
		border-top-right-radius: 0px;
		border-bottom-right-radius: 0px;
		transition: margin-left .5s ;
	  }
	  #searchbtn{
		margin-top: 7%;
		margin-left:0%;
		border-top-left-radius:0px;
		border-bottom-left-radius: 0px;
		background-color: #F0F0F0  ;
		width:5%;
		transition: margin-left .5s ;
	  }
	 .navbar-inverse{
			height:7%;
			width:100%;			
			transition: margin-left .5s;
			transition: margin-right .5s;
	 }
	 	
#accountmenu{


	padding-bottom:5%;
}

	 	#cog{
			width:5%;
	 		color:#FFFFFF;
	 		font-size:15px;
	 		
	 	}
	  .dropdown:hover .dropdown-menu{

	  	display: block;
	  }
	  
.title{
  border-bottom: 1px solid #ccc;
}

 #form{
	height:100%;
	z-index:1;
	 width: 0%; /* 0-25% */ 
    position: fixed; 
   
    top: 0;
    left: 0;
    
    overflow-x: hidden; 
    
    transition: 0.5s; 
}
label{
color: #FFFFFF;


}

#closebutton{
 background-color: #222222;
 border-color:#222222;
	margin-top:0;

}
#exit{
color:#FFFFFF;
font-size:1.5em;

}
.form-group{
 padding-top:15%;

}
 #checkbox{
 padding-top:5%;
 
 }
 #infobox{
 display: none;
 
 
 }

</style>
    <script ="text/JavaScript">
    jQuery.noConflict();
	
	var markers=[];
	var events=[];
 var config = {
    apiKey: "AIzaSyDlYhWf4GHAY75jlhyX-Fx4Ycy5-ZD9lFI",
    authDomain: "eventplanner-arthurchan.firebaseapp.com",
    databaseURL: "https://eventplanner-arthurchan.firebaseio.com",
    storageBucket: "eventplanner-arthurchan.appspot.com",
  };
  firebase.initializeApp(config);
  function initialize() {
  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 45,lng:  -95},
    zoom: 4,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    mapTypeControl:false,
    streetViewControl: false
  });
  /*
   var infoWindow = new google.maps.InfoWindow({map: map});
	if(navigator.geolocation){
	navigator.geolocation.getCurrentPosition(function(location) {
      var position = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
	  infoWindow.setPosition(pos);
      infoWindow.setContent('Location found.');
		 map.setCenter(position);
	}, function() {
      handleLocationError(true, infoWindow, map.getCenter());
    });
  } else {
    // Browser doesn't support Geolocation
    handleLocationError(false, infoWindow, map.getCenter());
  }


function handleLocationError(browserHasGeolocation, infoWindow, pos) {
  infoWindow.setPosition(pos);
  infoWindow.setContent(browserHasGeolocation ?
                        'Error: The Geolocation service failed.' :
                        'Error: Your browser doesn\'t support geolocation.');
}
  */
  var input = document.getElementById("map-search");
  var submit= document.getElementById("searchbtn");
  var form = document.getElementById("form");
 var navbar= document.getElementById("navigationbar");
 var markerplace=document.getElementById("markerplace");
  var searchBox = new google.maps.places.SearchBox(input);
  var addressBox = new google.maps.places.SearchBox(document.getElementById("address"));
 map.controls[google.maps.ControlPosition.TOP_CENTER].push(navbar);
  map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);
  map.controls[google.maps.ControlPosition.TOP_LEFT].push(submit);
  map.controls[google.maps.ControlPosition.LEFT_CENTER].push(form);

 
  map.addListener('bounds_changed', function() {
    searchBox.setBounds(map.getBounds());
  });
   searchBox.addListener('places_changed', function() {
   
    var places = searchBox.getPlaces();
	
    if (places.length == 0) {
     return;
    }

   
    markers.forEach(function(marker) {
      markers[0].setMap(null);
    });
   
  markers=[];
    
	var bounds = new google.maps.LatLngBounds();
    places.forEach(function(place) {
      var icon = {
        url: place.icon,
        size: new google.maps.Size(71, 71),
        origin: new google.maps.Point(0, 0),
        anchor: new google.maps.Point(17, 34),
        scaledSize: new google.maps.Size(25, 25)
		};

      markers.push(new google.maps.Marker({
        map: map,
        icon: icon,
        title: place.name,
        position: place.geometry.location
      }));
	  var title = place.name;
	   var eventString = "<div class='title'> <h3>" + place.name+ "</h3> </div>" 
	    + "<div class='link' id='eventformlink'><a href='#'> Click Here to Make an Event</a> </div>"; 
	   var infowindow = new google.maps.InfoWindow({
	    content:eventString
	   });
	  markers[0].addListener('click',function(){
		infowindow.open(map,markers[0]);
		document.getElementById("eventformlink").onclick= function(){
		  form.style.width = "25%";
			input.style.marginLeft="30%";
			submit.style.marginLeft="26%";
			document.getElementById("address").value = place.name.toString();
			document.getElementById("confirmevent").onclick=function(){
				var eventname= document.getElementById("eventname").value;
				var address= document.getElementById("address").value;
				var date= document.getElementById("date").value;
				var starttime= document.getElementById("starttime").value;
				var endtime= document.getElementById("endtime").value;
				var desc= document.getElementById("description").value;
				console.log(eventname);
				console.log(address);
				console.log(date);
				console.log(starttime);
				console.log(endtime);
				console.log(description);
		    };  
			
			};
			
		 document.getElementById("closebutton").onclick =function(){
		  form.style.width="0%";
		  input.style.marginLeft="2%";
		  submit.style.marginLeft="0%";
		  document.getElementById("makeevent").reset();
		 };
		 
		 
	  });
	  
	 

      if (place.geometry.viewport) {
    
        bounds.union(place.geometry.viewport);
      } else {
        bounds.extend(place.geometry.location);
      }
    });
    map.fitBounds(bounds);
  });

  submit.onclick =function(){
	google.maps.event.trigger(input,"focus")
	google.maps.event.trigger(input,"keydown",{
		keyCode: 13
	
	});
  
  };
  document.getElementById("createevent").onclick= function(){
			form.style.width = "25%";
			input.style.marginLeft="30%";
			submit.style.marginLeft="26%";
			navbar.style.marginLeft="25%";
			navbar.style.marginRight="50%";
			
		document.getElementById("address").onblur=function(){
			input.value=document.getElementById("address").value;
			google.maps.event.trigger(input,"focus")
			google.maps.event.trigger(input,"keydown",{
				keyCode: 9
	
			});
		
		};
		
		
		
		document.getElementById("closebutton").onclick =function(){
		  form.style.width="0%";
		  input.style.marginLeft="2%";
		  submit.style.marginLeft="0%";
		  navbar.style.marginLeft="0%";
		  navbar.style.marginRight="0%";
		  document.getElementById("makeevent").reset();
		 };
		
		
		
		};
		
   markerplace.onclick= function(event) {
          var marker = new google.maps.Marker({
          position: event.latLng,
          map: map
        });
        map.panTo(latLng);
        };
      
  
};    
    </script>
   
  </head>
  <body>
      
  
      <nav class="navbar-inverse" id="navigationbar">
      <div class="container-fluid">
		 <ul class="nav navbar-nav">
		 <li> <a href="#" id="createevent">Create an Event </a> </li>
		<li> <a href="#">Get Directions </a></li>
			<li > <a href="#"id="markerplace"  >Place Marker </a></li>
			<li> <a href="#" id="eventmanage"> Manage Events</a></li>
		 </ul>
		<ul class="nav navbar-nav navbar-right">
		<li> Welcome! </li>
		<li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" id="accountmenu" href="#"><span  id="cog" class="glyphicon glyphicon-cog"> </span> </a> 
			<ul class="dropdown-menu">
			<li> <a href="#"> Account Profile </a> </li>
			<li class="divider"> </li>
			<li> <a href="#"> Sign Out </a> </li>	

		</ul>
		</li>
		</ul>
		</div>
		</nav>
		
		
      <input id="map-search" type="text" class="form-control" placeholder="Enter a Location">

      <button class="btn btn-default" type="submit" id="searchbtn"><span class="glyphicon glyphicon-search"></span></button>



      

    <div id="map"></div>
	
	 <div class="container pull-left" id="eventform">
	
	  <div class="row" id="row">
			
        <ul class="nav navbar-inverse nav-stacked pull-left"id="form" >
         
		<form class= "nav  nav-stacked" id="makeevent" >
          <div class="pull-right">
            <button type="button" class="btn btn-default" id="closebutton"><span class="glyphicon glyphicon-remove" id="exit"></span></button>
          </div>
		<div class="form-group" id="eventnamegroup">
		<div class="col-md-12">
		<label> Event Name:*</label>
		<input type="text" class="form-control" id="eventname" placeholder="Enter Event Name">
		</div>
		</div>
		<div class ="form-group">
		<div class="col-md-12">
		<label> Address:* </label>
		<input type="text" class="form-control" id="address" placeholder="Enter Address">
		</div>
		</div>
		<div class="form-group">
		<div class="col-md-6">
		<label> Capacity: </label>
		<input type="number" class="form-control" min="1" id="capacity" >
		</div>
		</div>
		
		<div class="form-group">
		<div class="col-md-12">
		<label> Date:* </label>
		<input type="date" class="form-control" id="date" >
		</div>
		</div>
          <div class="form-group">
		  <div class="col-md-6">
            <label>Start Time:*</label>
            <input type="time" class="form-control" id="starttime"/>
			</div>
			<div class="col-md-6">
            <label>End Time:*</label>
            <input type="time" class="form-control" id="endtime"/>
			</div>
          </div>
		  <div class="form-group">
		  <div class="col-md-12">
		  <label> Description:*</label>
		  <input type="text" class="form-control" id="description">
		  </div>
		  </div>
		  <div class="form-group">
		  <div class="col-md-12">
		  <label>Invites:</label>
		  <textarea class="form-control" rows="4" id="invites" placeholder="Enter Invite Email Seperated by Comma: 123@example.com,abc@example.com ..."></textarea>
		  
		  </div>
		  </div>
		  <div class="form-group" >
		   <div class="col-md-6">
		  <label><input type="checkbox" value="">Need RSVP? </label>
		  </div>
		 </div>
		 <div class="form-group">
        <div class="col-md-12">
		  <button type="button" class="btn btn-default btn-block" id="confirmevent">Save Event</button>
		  </div>
		  </div>
		 
		 

		</form>
		</ul>
		</div>
		</div>
		
  
  
  </body>
</html>